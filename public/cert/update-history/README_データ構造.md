# 問題集 修正履歴 - データ構造ガイド

このドキュメントは、問題集の修正履歴を管理するためのデータ構造と、AIが更新作業を行う際の手順を説明します。

---

## ディレクトリ構造

```
update-history/
├── index.html              # 表示用HTML
├── style.css               # スタイルシート
├── index.json              # メタデータ（統計・月一覧）
├── README_データ構造.md     # このファイル
└── data/
    ├── 2025-11.json        # 2025年11月のデータ
    ├── 2025-12.json        # 2025年12月のデータ（例）
    └── ...                 # 月ごとに増加
```

---

## ファイル形式

### index.json（メタデータ）

**役割**: 全体の統計情報と、存在する月ファイルの一覧を管理

```json
{
  "stats": {
    "total": 24
  },
  "months": ["2025-11", "2025-10"]
}
```

| フィールド | 説明 |
|-----------|------|
| `stats.total` | 全期間の修正件数合計 |
| `months` | 存在する月ファイルの一覧（新しい順） |

### data/YYYY-MM.json（月別データ）

**役割**: 各月の修正履歴を格納

```json
{
  "month": "2025-11",
  "history": [
    {
      "date": "2025-11-27",
      "id": "SAP-44",
      "exam": "SAP",
      "summary": "図解の内容を問題に合わせて修正しました。"
    }
  ]
}
```

| フィールド | 説明 |
|-----------|------|
| `month` | 月の識別子（YYYY-MM形式） |
| `history` | その月の修正履歴の配列 |
| `history[].date` | 修正日（YYYY-MM-DD形式） |
| `history[].id` | 問題ID（例: SAP-44, SAA-13） |
| `history[].exam` | 試験区分（SAP, SAA, SOA, SCS, DVA, ANS, DOP, AIF, DEA, MLA, MLS） |
| `history[].summary` | 修正内容の要約（日本語） |

---

## AI向け: 更新作業フロー

### 1. 修正履歴を追加する場合

```
手順:
1. index.json を読み込む
2. 今日の日付から当月の月キー（YYYY-MM）を特定
3. 当月のファイル data/YYYY-MM.json を読み込む
   - ファイルが存在しない場合は新規作成
4. history 配列の先頭に新しいエントリを追加
5. data/YYYY-MM.json を保存
6. index.json の stats.total をインクリメント
7. 新しい月の場合は months 配列の先頭に追加
8. index.json を保存
```

### 2. 新しい月のファイルを作成する場合

```json
// 例: data/2025-12.json を新規作成
{
  "month": "2025-12",
  "history": [
    {
      "date": "2025-12-01",
      "id": "SAA-100",
      "exam": "SAA",
      "summary": "解説の記載を修正しました。"
    }
  ]
}
```

```json
// index.json を更新
{
  "stats": {
    "total": 25
  },
  "months": ["2025-12", "2025-11"]  // 先頭に新しい月を追加
}
```

### 3. 複数件を同時に追加する場合

当月ファイルの history 配列の **先頭** に新しいエントリを追加してください。  
日付が新しい順（降順）になるように並べます。

---

## 注意事項

1. **月ファイルは触らない限り読み込み不要**
   - 当月以外のファイルは基本的に編集しない
   - 過去データの修正が必要な場合のみ該当月を読み込む

2. **日付形式は統一**
   - 日付: `YYYY-MM-DD`（例: 2025-11-27）
   - 月: `YYYY-MM`（例: 2025-11）

3. **history 配列は新しい順**
   - 配列の先頭が最新のエントリ
   - index.html は日付でソートして表示するが、元データも新しい順が望ましい

4. **exam フィールドの値**
   - 大文字で統一: `SAP`, `SAA`, `SOA`, `SCS`, `DVA`, `ANS`, `DOP`, `AIF`, `DEA`, `MLA`, `MLS`

---

## index.html の動作

1. `index.json` を読み込み、月一覧を取得
2. 各月の `data/YYYY-MM.json` を並列で読み込み
3. 全データを結合して日付順にソート
4. フィルタリング・グループ化して表示

---

## 例: 今日（2025-12-15）に SAA-200 の修正を記録する

### 読み込むファイル
- `index.json`
- `data/2025-12.json`（存在しなければ新規作成）

### 更新後の index.json
```json
{
  "stats": {
    "total": 25
  },
  "months": ["2025-12", "2025-11"]
}
```

### 更新後の data/2025-12.json
```json
{
  "month": "2025-12",
  "history": [
    {
      "date": "2025-12-15",
      "id": "SAA-200",
      "exam": "SAA",
      "summary": "解説の記載順序を修正しました。"
    }
  ]
}
```

